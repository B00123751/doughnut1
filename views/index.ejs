
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />
<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

 <script src="https://cdnjs.cloudflare.com/ajax/libs/canvasjs/1.7.0/canvasjs.min.js"></script>
 
 






<script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>




<script src="http://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>


 
 
 
<script>


$(document).on("pagebeforecreate", "#driverdash",function(event){
     alert("pagecreate event fired!");
  
  $.get( "/checkStatus", function( data ) {
         if(data == "false"){
            window.location="/";
         }
    });



});

</script>



<style>
	.fakeimg {
		height: 200px;
		background: #aaa;

	}
	  
	.jumbotron{
		height:auto;
		padding:5px 0 !important;
		background-color:#db4914;
		margin-bottom:0
	}
	
	 
	.footer {
		position: fixed;
		left: 0;
		bottom: 0;
		width: 100%;
		background-color: black;
		color: white;
		text-align: center;
	}
	
	.jumbotron h1{
    color: #fff;
}

.jumbotron p{
    color: #fff;
	
	

	
}

//.container{		background-color:#db4914;}


</style>


<div data-role="page" id="homepage">
	<title>Home page</title>
	<div class="jumbotron text-center">
		<h1>Best Doughnuts live here!</h1>
		<p>We make best doughnuts. You can order them here!</p> 
	</div>
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
		<a class="navbar-brand" href="#homepage">Homepage</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="collapsibleNavbar">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a class="nav-link" href="#register">Register</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="#login">Login</a>
				</li>
			</ul>
		</div>  
	</nav>

	<div class="container" style="margin-top:30px">
		<div class="row">

			<div class="col-sm-8">
				<h2>We make delicious fresh doughnuts to order</h2>
				<img src="images/shop2.jpg" >
				<p>Fresher than ever..</p>
				<p>To order, please login or register</p>
			</div>
		</div>
		<div class="footer">
			  <p>B00123751</p>
		</div>
	</div>

	</html>
</div><!-- /homepage -->

<div data-role="page" id="register">
	<title>Register</title>
	<div class="jumbotron text-center">
		<h1>Best Doughnuts live here!</h1>
		<p>We make best doughnuts. You can order them here!</p> 
	</div>
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
		<a class="navbar-brand" href="#homepage">Homepage</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="collapsibleNavbar">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a class="nav-link" href="#register">Register</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="#login">Login</a>
				</li>
			</ul>
		</div>  
	</nav>

	<div class="container" style="margin-top:30px">
		<div class="row">

			<div class="col-sm-8">									
				
				<div role="main" class="ui-content">
				
					Username <input type="text" id="username"/> <br>
					E-mail <input type="text" id="email"/> <br>
					Password <input type="text" id="password"/> <br>
					Account type <input type="text" id="acctype"/> <br>
					<button id="submitbutton"> Submit Button </button>
				
				</div><!-- /content -->
			</div>
		</div>
	</div>
	
	<div class="footer">
		<p>Footer</p>
	</div>		
	</html>
		
</div><!-- /register page -->



<script>
	// Registration, when the submitbutton is clicked
	$( "#submitbutton" ).click(function(event) {
	  // stop the default redirect of the browser
	  event.preventDefault();
	  
	  // grab the values
	  var username = $('#username').val();
	  var email = $('#email').val();
	  var password = $('#password').val();
	  var acctype = $('#acctype').val();
	  var isValid = true;
	  
	  if(username == ""){
		 alert("Please enter a username");
		 isValid = false;
	  }
	  if(!email.includes("@")){
		 alert("Please enter a valid email");
		 isValid = false;
	  }

	 // only send the data to the database, if the param is true.
	  if(isValid == true){
		  // send the data to the server-side
		  $.post( "/putInDatabase", { username: username, email: email, password:password, acctype:acctype })
		  .done(function( data ) {
			//alert( "Data Loaded: " + data );
		  });
	  }
	});

</script>

<div data-role="page" id="login">
	<title>Login</title>
	<div class="jumbotron text-center">
		<h1>Best Doughnuts live here!</h1>
		<p>We make best doughnuts. You can order them here!</p> 
	</div>
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
		<a class="navbar-brand" href="#homepage">Homepage</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="collapsibleNavbar">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a class="nav-link" href="#register">Register</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="#login">Login</a>
				</li>
			</ul>
	  </div>  
	</nav>
	
	
	<div class="container" style="margin-top:30px">
		<div class="row">
			<div class="col-sm-8">
				<div role="main" class="ui-content">
					Username <input type="text" id="loginUsername"/> <br>
					Password <input type="text" id="loginPassword"/> <br>
					<button id="loginbutton"> Login  </button>
				</div><!-- /content -->
			</div>
		</div>
	</div>
	
	<div class="footer">
		<p>Footer</p>
	</div>
	</html>
</div><!-- /page -->


<script>
	// when the submitbutton is clicked
	$( "#loginbutton" ).click(function(event) {
	  // stop the default redirect of the browser
	  event.preventDefault();
	  
	  // grabbing the values
	  var un = $('#loginUsername').val();
	  var pw = $('#loginPassword').val();
	  
	  if(un == "")
	  {
		 alert("Please enter a username");
	  }
	  if(pw ==""){
		alert("please enter a password");
	  }
	  
	  
	  $.post( "/checkTheLogin", { username: un, password: pw })
		  .done(function( data ) {
			// say what the account type is
			//alert( "Data Loaded: " + data );
			
			if(data.includes("customer")){
			
			   // move to the customer dashboard
			   window.location="/#customerdash";
			}
			else if(data.includes("driver")){

				$.get( "/getDriverData", function( data ) {
				// throw the data onto the driver page
					$( "#driverOutput" ).html( data );
			  
				});



			
			   // move to the driver dashboard
			   
				 window.location="/#driverdash";
			}
			else if(data.includes("manager")){
			
			
			   // make a call to the severside to get the data!
				$.get( "/getManagerData", function( data ) {
				// throw the data onto the manager page
					$( "#managerOutput" ).html( data );
			  
				});
			   // move to the manager dashboard
			   window.location="/#manager";
			}
		  });
	 }); 
</script>

<script>
	var myCart = [];
</script>















<div data-role="page" id="customerdash">
	<title>Home page</title>
	<div class="jumbotron text-center">
		<h1>Best Doughnuts live here!</h1>
		<p>We make best doughnuts. You can order them here!</p> 
	</div>
	
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
		<a class="navbar-brand" href="#homepage">Homepage</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
			<span class="navbar-toggler-icon"></span>
		</button>
		
		<div class="collapse navbar-collapse" id="collapsibleNavbar">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a class="nav-link" href="#customerdash">Our doughnuts</a>
				</li>
			</ul>
		</div>  
	</nav>


	<div class="container" style="margin-top:30px">
		<div class="row">
			<div class="col-sm-8">
				<div role="main" class="ui-content">
					<div id="productdata"> </div>
					<script>
						// pulling product data from the database via apps.js	
						$.get( "/getProducts", function( data ) {
						$("#productdata").html(data);
						});
					</script>
					<button id="goToCheckout"> Checkout </button>
					<br>
					<br>        
					<br>         
				</div><!-- /content -->
			</div>
		</div>
	</div>
	<div class="footer">
		  <p>B00123751</p>
	</div>
	</html>
</div><!-- /page -->










<div data-role="page" id="driverdash">
	<title>Home page</title>
	<div class="jumbotron text-center">
		<h1>Best Doughnuts live here!</h1>
		<p>We make best doughnuts. You can order them here!</p> 
	</div>
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
		<a class="navbar-brand" href="#homepage">Homepage</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
			<span class="navbar-toggler-icon"></span>
		</button>
		  <div class="collapse navbar-collapse" id="collapsibleNavbar">
				<ul class="navbar-nav">
					<li class="nav-item">
						<a class="nav-link" href="#register">Register</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="#login">Login</a>
					</li>
				</ul>
		  </div>  
	</nav>

	<div class="container" style="margin-top:30px">
		<div class="row">
			<div class="col-sm-8">
				<h1>You are logged in as Driver</h1>
				<p>Below is the weather and customer orders</p>
				
				<!-- GUI ready from https://forecast7.com -->
				<a class="weatherwidget-io" href="https://forecast7.com/en/53d51n6d40/ashbourne/" data-label_1="ASHBOURNE" data-label_2="WEATHER" data-theme="original" >ASHBOURNE WEATHER</a>
				<script>
				!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src='https://weatherwidget.io/js/widget.min.js';fjs.parentNode.insertBefore(js,fjs);}}(document,'script','weatherwidget-io-js');
				</script>

				 <!--  j s o n  from weatherstack -->
				<script>
						$.getJSON( "http://api.weatherstack.com/current?access_key=573b1725ec605b6282147b8f429c3756&query=Dublin", function( json ) {
						  console.log( "JSON Data: " +json.current.temperature );
						  
						  $('#currentTemp').html(json.current.temperature);
							$('#currentPressure').html(json.current.pressure);
						 });
				</script>
			 
				<script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=reNwiGs_QqEUyqxRdb-SpG3sTHimTa59F_-bv10DrsWi53_HJyRtPP5yHXQ1j8sCgG6iGsXgFEFe5IlL-7Ck_xL1MKC57ySghbdoZ1uWhuQfRRocyJa7zg2iWVThE5nclZnUL7EwoyLvalHND-_yliHkml8xR7WfqUpf6WbPEVA" charset="UTF-8"></script><script
				  src="https://code.jquery.com/jquery-3.5.1.js"
				  integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
				  crossorigin="anonymous"></script>
			  
				The current temperature is: <div id="currentTemp"> </div>  
				The current pressure is: <div id="currentPressure"> </div>  	

			</div>
		</div>
	</div>
	
	<div class="container" style="margin-top:30px">
		<div class="row">
			<div class="col-sm-8">

				<div role="main" class="ui-content">
					<h2>All pending customer orders:</h2>
					<div id="driverOutput">
					</div>
				</div><!-- /content -->
			</div>
		</div>
	</div>	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<div class="footer">
		  <p>B00123751</p>
	</div>
	</html>
</div><!-- /page -->





<script>
	//  when the markdelivered is clicked
	 function changetodelivered(recid) {
	   
       
         //alert(recid);
	  
	 
	    
	 
          $.post( "/updateDB", { recid: recid})
          .done(function( data ) {
           // alert( "Data Loaded: " + data );
          });

         

	}

</script>





<script>
	//  when the markdcancelled is clicked
	 function changetocancelled(recid) {
	   
       
         //alert(recid);
	  
	 
	    
	 
          $.post( "/updateDBcancel", { recid: recid})
          .done(function( data ) {
            //alert( "Data Loaded: " + data );
          });

         

	}

</script>







<div data-role="page" id="checkoutreview">

	<title>Checkout</title>
	<div class="jumbotron text-center">
		<h1>Best Doughnuts live here!</h1>
		<p>Review your order</p> 
	</div>
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
		<a class="navbar-brand" href="#homepage">Homepage</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="collapsibleNavbar">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a class="nav-link" href="#customerdash">Changed my mind?</a>
				</li>
			</ul>
		</div>  
	</nav>

	<div class="container" style="margin-top:30px">
		<div class="row">
			<div class="col-sm-8">
				<div role="main" class="ui-content">
					<div id="products">
					</div>
					Address <input type="text" id="address"/> <br>							
					<button id="insertintodb">Complete Checkout</button>
				</div><!-- /content -->
			</div>
		</div>
	</div>
	<div class="footer">
		  <p>B00123751</p>
	</div>
	</html>
</div><!-- /page -->


<div data-role="page" id="checkoutComplete">
	<title>Checkout complete!!!</title>
	<div class="jumbotron text-center">
		<h1>Best Doughnuts live here!</h1>
		<p>We make best doughnuts. You can order them here!</p> 
	</div>
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
		<a class="navbar-brand" href="#homepage">Homepage</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="collapsibleNavbar">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a class="nav-link" href="#register">Register</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="#login">Login</a>
				</li>
			</ul>
		</div>  
	</nav>

	<div class="container" style="margin-top:30px">
		<div class="row">
			<div class="col-sm-8">
				<h1>Your checkout complete!</h1>
				<br><br>
				<p>Thank You for shopping. You order is getting ready for the delivery.<p>
			</div>
		</div>
	</div>
	
	<div class="footer">
		  <p>B00123751</p>
	</div>
	</html>
</div><!-- /page -->




<script>
	$( "#insertintodb" ).click(function() {

		// get the persons username
		 var orderby = $('#loginUsername').val();
		 var address = $('#address').val();
		 var isValid = true;			 
		  if(address == ""){
			 alert("Please enter the address");
			 isValid = false;
		  }


	 
		 // get the list of products from the shopping cart
		 var items = myCart.toString();
		 if(isValid == true){		 
			 $.post( "/completeCheckout", { orderby:orderby, items:items, address:address })
				  .done(function( data ) {
					//alert( "Data Loaded: " + data );
							// move to to the checkout review
				window.location="/#checkoutComplete";
					
				  });      
		 }
	});
</script>






<script>

	// this function triggers, every time a page is loaded
	$(document).on("pagecreate",function(event){
	  
	  
	  $.get( "/checkIfTimeLeft", function( data ) {
	 
			  if(data.includes("ok")){
			  
			  } else {
				  
				   // session expired
				   window.location="/";
			  }
		});
	  
	});



	$( "#goToCheckout" ).click(function() {

			// update the div tag with the shopping cart
			
			var cartItems = myCart.toString().split(',');
			// for each record, append them to the procuts div.
			
			// wipe the products div tag!
			$('#products').html('');
			
			var total = 0; 
	 
			for(var i=0; i< cartItems.length; i++){
				
				
				var singleRecord = cartItems[i].split('-');
				
								 // qty *  cost of one item
				var itemTotal = singleRecord[1] * singleRecord[2];    
				
				// add it on to our running total. 
				total = total + itemTotal;
				
				$('#products').append("Item #"+(i+1)+": "+cartItems[i] + '<br>');

		   }
			
			$('#products').append("Total cost of order: â‚¬"+total);     
		   

			// move to to the checkout review
			window.location="/#checkoutreview";
	});


	function deleteProduct(item){
		
		// loop over the cart
		myCart.forEach(function(itemCurrent, index, array) {
					
				   // look for the item we want to delete.
				   if(itemCurrent.includes(item)){
					  console.log("Removing previous reference to " + item);
					  myCart.pop(index);
				   }
			});
	}

	function addToCart(itemName,cost){
		// finding out the name of the ITEM we are adding
		var item = itemName;
		console.log(item);
		
		// dynamically find out the qty
		var qty = $('#'+item).children("option:selected").val();
		console.log(qty);
		
		// search the cart and see if we already added
		// the item. If we did, remove the old qty.

		myCart.forEach(function(itemCurrent, index, array) {
			   
			   
			   
			   if(itemCurrent.includes(item)){
				  console.log("Removing previous reference to " + item);
				  myCart.pop(index);
			   }
		});
		
		
		// add the item to the cart
		myCart.push(item + '-' + qty + '-'+ cost);
		
		//alert(myCart);

		// put in the session
		$.post( "/putInSession", { cart: myCart} );
		


	}

</script>



<div data-role="page" id="manager">
	<title>Manager tab</title>
	<div class="jumbotron text-center" >
		<h1>Best Doughnuts live here!</h1>
		<p>We make best doughnuts. You can order them here!</p> 
	</div>
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
		<a class="navbar-brand" href="#homepage">Homepage</a>
		

		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
			<span class="navbar-toggler-icon"></span>
		</button>
	  
		<div class="collapse navbar-collapse" id="collapsibleNavbar">
			<ul class="navbar-nav">


					<li class="nav-item">
					<a class="nav-link" href="#manager">All Orders</a>
				</li>			
	

				<li class="nav-item">
					<a class="nav-link" href="#chart2">Charts</a>
				</li>


				
				<li class="nav-item">
					<a class="nav-link" href="#register">Register</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="#login">Login</a>
				</li>
			</ul>
		</div>  
	</nav>

	<div class="container" style="margin-top:30px">
		<div class="row">
			<div class="col-sm-90">
				<h1>You are logged in as Manager</h1>
				<div role="main" class="ui-content">
					<p>All customer orders:</p>
					
					
					
					
					
					
					
					
					
					
					
	
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					
					<br>
					<div id="managerOutput">
					</div>
								
       


								
						 Select start Date: <input type="date" id="datepicker"></p>
						 
						 <script>
							 $( function() {
								$( "#datepicker" ).datepicker({ dateFormat: 'yy-mm-dd' });
							  } );
						  </script>
						  
						  <button onclick="getRangeDatepicker()"> Get Range Data up to today </button>
						  
						  
						  
						  
						  
						 
						 <select id="getOrderByRange">
							 <option value="7">  7 days </option>
							 <option value="30">  30 days </option>
								  
						 </select>
						 
						 <button onclick="getRangeData()"> Get Range Data </button>
						 
						 <div id="rangeData">
						 
						 </div>
						 
						 
						 <script>
							 function getRangeData(){
							 
							 // 7 or 30 days   
							var range = $('#getOrderByRange').children("option:selected").val();
						   
								 
								 $.post( "/getRangeData", { range: range} )
								  .done(function( data ) {
									$('#rangeData').html(data);
								  });
							 
							 }
							 
							 function getRangeDatepicker(){
							 
								// getting the date
								var date = $('#datepicker').val();
						   

								 $.post( "/getRangeDatePicker", { range: date} )
								  .done(function( data ) {
									$('#rangeData').html(data);
								  });
					 
							 }
						 
						 </script>
						 
						 
						  <button onclick="logout()">Log out</button>
						<script>

							function logout(){

							   $.post( "/logout", function( data ) {
									
									window.location="/";
									
								});

							}

						</script>

					
				</div><!-- /content -->
			</div>
		</div>
	</div>
	
	
	
	


	<br><br><br>
	<div class="footer">
		  <p>B00123751</p>
	</div>
	</html>
</div><!-- /page -->



























































<div data-role="page" id="chart2">
	<title>Chart2 tab</title>
	<div class="jumbotron text-center" >
		<h1>Best Doughnuts live here!</h1>
		<p>We make best doughnuts. You can order them here!</p> 
	</div>
	<nav class="navbar navbar-expand-sm bg-dark navbar-dark">
		<a class="navbar-brand" href="#homepage">Homepage</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
			<span class="navbar-toggler-icon"></span>
		</button>
	  
		<div class="collapse navbar-collapse" id="collapsibleNavbar">
			<ul class="navbar-nav">


					<li class="nav-item">
					<a class="nav-link" href="#manager">All Orders</a>
				</li>			
	

				<li class="nav-item">
					<a class="nav-link" href="#chart2">Charts</a>
				</li>


				
				<li class="nav-item">
					<a class="nav-link" href="#register">Register</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="#login">Login</a>
				</li>
			</ul>
		</div>  
	</nav>

	<div class="container" style="margin-top:30px">
		<div class="row">
			<div class="col-sm-90">
				<h1>Order Revenue Charts</h1>
				<div role="main" class="ui-content">
					
					
					

					
				</div><!-- /content -->
			</div>
		</div>
	</div>
	
	
	
	<script>

    


 var dataPointsB = [];
 var liveData2; // this will contain the string with the numbers separated
                  // by a comma

    $.get( "/getGraphData2", function( data ) {
       
       
       liveData2 = data;
	   console.log(liveData2);
     });  
       
	   
	   
	   
	   
	   
	 var dataPointsC = [];
 var liveData3; // this will contain the string with the numbers separated
                  // by a comma

    $.get( "/getGraphData3", function( data ) {
       
       
       liveData3 = data;
	   console.log(liveData3);
     });     
	   
	   
	   
	   
	 var dataPointsD = [];
 var liveData4; // this will contain the string with the numbers separated
                  // by a comma

    $.get( "/getGraphData4", function( data ) {
       
       
       liveData4 = data;
	   
	   

	   console.log(liveData4);
     });     
	   	



	   
	   
	   
	 var dataPointsE = [];
 var liveData5; // this will contain the string with the numbers separated
                  // by a comma

    $.get( "/getGraphData5", function( data ) {
       
       
       liveData5 = data;
	   
	   

	   console.log(liveData5);
     });    
	   	


	 var dataPointsF = [];
 var liveData6; // this will contain the string with the numbers separated
                  // by a comma

    $.get( "/getGraphData6", function( data ) {
       
       
       liveData6 = data;
	   
	   

	   console.log(liveData6);
     });  
	
	



	  
     
window.onload = function () {

    
     
    var result2 = liveData2.split(',');
    console.log(result2);
    //
    // this plots the X and Y for each data point
    //
    for (var i = 1; i < result2.length; i++) {
        
        dataPointsB.push({
              x: i,
              y: parseFloat(result2[i])
			  
            });        
         	       
     }
     console.log(dataPointsB);
    
    
    
    var chart2 = new CanvasJS.Chart("chartContainer2", {
	animationEnabled: true,
	theme: "light2", // "light1", "light2", "dark1", "dark2"
	title:{
		text: "Order Revenues by ID Barc Chart"
	},
	axisY: {
		title: "Revenue"
	},
	
	axisX: {
	title: "ID"
	},
	data: [{        
		type: "column",  
		showInLegend: false, 
		legendMarkerColor: "grey",
		legendText: "",	
		dataPoints: dataPointsB
	}]
   });


chart2.render();









    var result3 = liveData3.split(',');
    console.log(result3);
    //
    // this plots the X and Y for each data point
    //
    for (var i = 1; i < result3.length; i++) {
        
        dataPointsC.push({
              x: i,
              y: parseFloat(result3[i])
			  
            });        
         	       
     }
     console.log(dataPointsC);
    
    
    
	var chart3 = new CanvasJS.Chart("chartContainer3", {
		theme: "light2", // "light1", "light2", "dark1", "dark2"
		exportEnabled: true,
		animationEnabled: true,
		title: {
			text: "Order Revenue by Order ID Pie Chart "
		},
		data: [{
			type: "pie",
			startAngle: 0,
			
			showInLegend: "true",
			legendText: "{label}",
			indexLabelFontSize: 16,
			
			dataPoints: dataPointsC
			
		}]
	});


chart3.render();










    var result4 = liveData4.split(',');
    console.log(result4);
    //
    // this plots the X and Y for each data point
    //
    for (var i = 1; i < result4.length; i++) {
        
        dataPointsD.push({
              x: i,
              y: parseFloat(result4[i])
			  
            });        
         	       
     }
     console.log(dataPointsD);
    
    
    
	var chart4 = new CanvasJS.Chart("chartContainer4", {
	animationEnabled: true,
	title:{
		text: "Revenue by Order"
	},
	axisX:{
		title: "ID"	
	},
	axisY: {
		title: "Revenue ",
		includeZero: false,
		scaleBreaks: {
			autoCalculate: true
		}
	},
	data: [{
		type: "line",
	 
		color: "#F08080",
		isCumulativeSum : true ,
		dataPoints: dataPointsD
		
			
		}]
	});


chart4.render();






















   var result5 = liveData5.split(',');
    console.log(result5);
	
	
	
    //
    // this plots the X and Y for each data point
    //
    for (var i = 1; i < result5.length; i++) {
        
        dataPointsE.push({
              x: i,
              y: parseFloat(result5[i])
			  
            });        
         	       
     }
     console.log(dataPointsE);
	 
	 

    
    
    
	var chart5 = new CanvasJS.Chart("chartContainer5", {
	animationEnabled: true,  
	title:{
		text: "Revenue Spline Chart with Average "
	},
	axisY: {
		title: "Revenue",
		valueFormatString: "#0,,.",
		suffix: "mn",
		stripLines: [{
			value: 23.8,
			label: "Average"
		}]
	},
	data: [{
		yValueFormatString: "#,### Units",
		xValueFormatString: "YYYY",
		type: "spline",
		dataPoints: dataPointsE
	}]
	});


chart5.render();













   var result6 = liveData6.split(',');
    console.log(result5);
	
	
	
   for (var i = 1; i < result6.length; i++) {
        
        // This is two parts, a key and a value 
        // separated by a space.
        var keyPair = result6[i]; // group1 20
        console.log(keyPair);
        
        
        var keyPair = keyPair.split(" "); // position 0 would be group1
                              
                                //   position 1 would be 20
        
        console.log("word is" + keyPair[1]);
        
        
        dataPointsF.push({
              label: keyPair[1],
              y: parseFloat(keyPair[2])
            });        
     
     }
     console.log(dataPointsF);
	 
	 

    
    
    
    var chart6 = new CanvasJS.Chart("chartContainer6", {
	animationEnabled: true,
	theme: "light2", // "light1", "light2", "dark1", "dark2"
	title:{
		text: "Revenue bar Chart with groupings from the DB"
	},
	axisY: {
		title: "Revenue "
	},
	data: [{        
		type: "column",  
		showInLegend: false, 
		legendMarkerColor: "grey",
		legendText: "NA",
		dataPoints: dataPointsF
	}]
});


chart6.render();

























       
}


</script>


<div id="chartContainer2" style="height: 370px; max-width: 920px; margin: 0px auto;"></div>	

<br><br><br><br><br>	
<div id="chartContainer5" style="height: 370px; max-width: 920px; margin: 0px auto;"></div>		

<br><br><br><br><br>	
<div id="chartContainer3" style="height: 370px; max-width: 920px; margin: 0px auto;"></div>		

<br><br><br><br><br>	
<div id="chartContainer4" style="height: 370px; max-width: 920px; margin: 0px auto;"></div>	

<br><br><br><br><br>	
<div id="chartContainer6" style="height: 370px; max-width: 920px; margin: 0px auto;"></div>	


	<br><br><br>
	<div class="footer">
		  <p>B00123751</p>
	</div>
	</html>
</div><!-- /page -->














<script>
// generic method of checking every pages login is valid
$(document).on("pagebeforecreate",function(event){
     
     console.log("Page Before Create called");
    
      // Finding out what the type of page is being
      // accessed, if it is a manager page, driver page etc
      // if we want to see should the user be on the page
      // with their account type.
      var url = $(location).attr('href');
      var acctype = '';
      
      if(url.endsWith('#manager')){
           acctype = 'manager';
      }
      if(url.endsWith('#driverdash')){
           acctype = 'driver';
      }
      console.log("acc type we are checking:"+acctype);
       
      console.log(url);
      
      var shouldWeTestValidation = true;
          //
          // If we are on the home page
          // or if we are on the login page
          // don't attempt to redirect the user!
          var n = url.endsWith("3000");
          var nn = url.endsWith("3000/");
          
          if(n  == true || nn == true){
             console.log("on the index page");
             shouldWeTestValidation = false;
          }
          
          var n = url.endsWith("/#login");
          if(n == true){
             console.log("on the login page");
             shouldWeTestValidation = false;
          }
       
         if(shouldWeTestValidation == true){
            console.log("checking login validation");
            
            
            
             // send the acc type we are checking also
             // this will be a driver or a manger if we
             // happen to be on that page.
            $.post( "/checkStatus", { acctype: acctype })
              .done(function( data ) {
                
                console.log(data);
                
                if(data.includes("false")){
                   window.location="/";
                 }
              });
            
            
            
         }

});


$(document).on("pagebeforecreate", "#driverdash",function(event){
     alert("pagecreate event fired!");
  
  $.get( "/checkStatus", function( data ) {
         if(data == "false"){
            window.location="/";
         }
    });



});

</script>



































